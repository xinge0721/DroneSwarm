# DroneSwarm 无人机集群控制系统

基于ESP32-S3的无人机控制系统，集成GPS定位、姿态控制和ROS上位机通信，构建可扩展的无人机集群平台。

## 项目架构

本项目采用**三层架构设计**：
```
┌─────────────────┐    WiFi-UDP    ┌──────────────────┐
│   无人机端      │ ◄─────────────► │    上位机ROS     │
│   (ESP32-S3)    │                │   (Ubuntu/ROS1)  │
└─────────────────┘                └──────────────────┘
        │                                    │
        ▼                                    ▼
  姿态控制+GPS定位              路径规划+数据处理+监控
```

## 项目结构

```
DroneSwarm/
├── docs/                       # 📋 项目文档
│   └── 技术路线规划.md          # 详细的系统设计文档
├── Hardware/                   # 🔧 硬件设计文件
│   ├── CDA/                    # 3D机身模型
│   └── PCB/                    # 电路板设计
├── Software/                   # 💻 软件代码
│   ├── UAV_ESP/                # ✅ ESP32固件 (开发中)
│   │   ├── Hardware/           # 硬件驱动模块
│   │   ├── System/             # 系统功能模块
│   │   └── main/               # 主程序
│   └── Hive_control_ROS/       # 🚧 ROS上位机 (开发中)
│       └── src/                # ROS功能包框架
└── test/                       # 🧪 测试文件
```

## 开发状态

> 🚨 **注意**: 这是个人学习项目，大部分代码还在开发中，很多模块只是搭建了基础框架

### 🚧 当前开发中
- **ESP32固件框架** - 基于ESP-IDF，部分复用以前代码
  - 🏗️ 基础WiFi/UDP通信框架
  - 🏗️ 硬件驱动模块（13个模块框架已建立）
    - 传感器接口定义（GPS/JY60/MPU6050等）
    - 执行器控制接口（PWM/LED/蜂鸣器等）
  - 🏗️ 系统算法模块
    - PID控制器（基础实现）
    - 卡尔曼滤波（框架搭建）
  - ✅ 编译构建系统

### 📋 ROS上位机部分
- **四大功能包** - 只有基础CMake框架，功能待实现
  - 📦 `udp_ros_bridge` - UDP↔ROS话题转换（空壳）
  - 📦 `swarm_data_processor` - 数据处理（空壳）
  - 📦 `swarm_planner` - 路径规划（空壳）
  - 📦 `swarm_monitor` - 监控可视化（空壳）

### 🎯 下一步计划
- 完善ESP32各硬件模块的具体实现
- 集成测试WiFi通信和传感器数据读取
- 逐步实现ROS功能包的核心功能
- 硬件调试和PID参数调优

## 设计目标

### 🎯 ESP32固件端（规划中）
- **多传感器融合**：JY60姿态+NEO-M8N GPS+电池监控
- **高频控制循环**：目标100Hz姿态控制，50Hz数据上传
- **实时参数调试**：UART0接口支持PID参数实时调整
- **资源优化设计**：硬件资源精确分配，避免冲突

### 🖥️ ROS上位机端（规划中）
- **模块化架构**：四个功能包各司其职，便于扩展
- **坐标系转换**：GPS经纬度→UTM坐标，便于路径计算
- **实时监控**：电池电压、GPS信号强度、飞行状态
- **可视化界面**：RViz显示飞行轨迹和系统状态

## 快速开始

### 环境要求
- **无人机端**：ESP-IDF v5.0+
- **上位机端**：Ubuntu 20.04 + ROS Noetic
- **硬件**：ESP32-S3 + JY60 + NEO-M8N + OLED显示屏

### 编译ESP32固件
```bash
cd Software/UAV_ESP
idf.py build
idf.py flash monitor
```

### 编译ROS功能包
```bash
cd Software/Hive_control_ROS
catkin_make
source devel/setup.bash
```

## 硬件配置

| 模块 | 型号 | 接口 | 功能 |
|------|------|------|------|
| 主控 | ESP32-S3 | - | 双核处理器，240MHz |
| 姿态传感器 | JY60 | UART2 | 三轴姿态数据 |
| GPS模块 | NEO-M8N | UART1 | 室外定位 |
| 显示屏 | 0.96" OLED | I2C1 | 状态显示 |
| 电机驱动 | 8520空心杯×4 | PWM | 四轴推进 |

## 通信协议

### UDP数据格式（JSON）
```json
{
  "drone_id": "test_01",
  "roll": 1.1, "pitch": 0.8, "yaw": 359.2,
  "lat": 30.123456, "lon": 120.654321,
  "sat": 13, "batt": 3.85,
  "pid_p": 2.5, "pid_i": 0.3, "pid_d": 0.8
}
```

### 网络配置
- **ESP32 IP**：192.168.1.101（固定）
- **上位机端口**：8888（UDP）
- **数据频率**：50Hz上传，20Hz下载

## 开发笔记

这是个人学习和研究无人机控制系统的项目，目标是：
- 深入理解ESP32嵌入式开发
- 学习ROS机器人操作系统
- 掌握多传感器融合和控制算法
- 探索无人机集群协同控制

## 项目状态

- **当前版本**: v0.1.0-alpha
- **开发阶段**: 框架搭建
- **更新日期**: 2025-10-07

如果你对无人机控制、ESP32开发或ROS系统感兴趣，欢迎参考本项目的代码和文档。

